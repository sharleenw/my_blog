---
title: 'Hamilton Christmas Bird Count: Part 2'
subtitle: 'Visualising the Hamilton CBC data'
author: Sharleen
date: '2019-02-10'
slug: hamilton-christmas-bird-count-part-2
summary: Visualising the Hamilton CBC data.
categories: []
tags:
  - data analysis
  - R
  - natural history
  - ornithology
  - ecology
  - birding
  - ggplot2
  - tidyverse
draft: true
image:
  caption: 'Northern Cardinal image credit: [**Public Domain Files**](http://www.publicdomainfiles.com/show_file.php?id=13962429013391)'
  preview_only: false
  
bibliography: part_2.bib
link-citations: true

---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<div id="note" class="section level1">
<h1>Note</h1>
<p>This is the second part of three for this dataset. <a href="https://sharleenw.rbind.io/post/hamilton_cbc_part_1/hamilton-christmas-bird-count-part-1/">Part 1</a> contains data downloading and cleaning, Part 2 contains visualisations and Part 3 contains my Shiny app!</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Now that we have the data cleaned into a form that we like, we can start visualising it!</p>
<p>A wonderful reference I’ve been using is the book <strong>Birds of Hamilton and Surrounding Areas</strong> by Robert Curry and the Hamilton Naturalists’ Club, particularly the chapter called <em>Hamilton Christmas Bird Count</em> by Ian Richards. This book contains a encyclopaedic overview of the history and current state of birds in the Hamilton Study Area. It is 676 pages long and is an absolutely marvelous source of information!</p>
<p>Let’s walk through what I am hoping to learn from this dataset.</p>
<ol style="list-style-type: decimal">
<li><p>Compare the first count year to the latest year</p></li>
<li><p>How many species are seen each year</p></li>
<li><p>Highlight certain species to see if there are any changes over time</p></li>
</ol>
<p>This data is only an annual snapshot of the number of birds, and that number depends on several factors, mentioned in <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>:</p>
<ul>
<li>the number of volunteers</li>
<li>the weather of count day</li>
<li>the date of the count, which has mostly been on Dec 26 since 1974, but has varied anywhere between Dec 16 and Dec 31</li>
</ul>
<p>This dataset also doesn’t show the populations of species that migrate out of Hamilton in the winter.</p>
</div>
<div id="visualising" class="section level1">
<h1>Visualising</h1>
<p>To start, we’ll load all of the packages we’ll be using and set the plot theme:</p>
<pre class="r"><code>library(dplyr)
library(janitor)
library(readr)
library(naniar)
library(lubridate)
library(measurements)
library(stringr)
library(ggplot2)
library(here)
library(tidyr)
library(knitr)
library(kableExtra)

theme_set(theme_minimal())</code></pre>
<div id="comparing-the-counts-first-and-latest-year" class="section level2">
<h2>Comparing the count’s first and latest year</h2>
<p>Let’s start by looking at the first year anyone went out to do the count, in 1921. In <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>, Ian Richards mentions that 2 observers went out that year, for 8 hours.</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(year == min(year),
         how_many_counted != 0) %&gt;%
  select(species, how_many_counted) %&gt;%
  arrange(-how_many_counted, species) %&gt;%
  kable() %&gt;%
  kable_styling(full_width = FALSE, position = &quot;left&quot;)</code></pre>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:right;">
how_many_counted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
American Tree Sparrow
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
Black-capped Chickadee
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
Blue Jay
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Downy Woodpecker
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
White-breasted Nuthatch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
American Robin
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Brown Creeper
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Gray Jay
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Ruffed Grouse
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Oh wow, they saw a Gray Jay! How many times have Gray Jays been seen on Hamilton CBCs?</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(species == &quot;Gray Jay&quot;,
         how_many_counted != 0) %&gt;%
  kable() %&gt;%
  kable_styling(full_width = FALSE, position = &quot;left&quot;)</code></pre>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
species_latin
</th>
<th style="text-align:right;">
how_many_counted
</th>
<th style="text-align:right;">
total_hours
</th>
<th style="text-align:right;">
how_many_counted_by_hour
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1921
</td>
<td style="text-align:left;">
Gray Jay
</td>
<td style="text-align:left;">
Perisoreus canadensis
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.125
</td>
</tr>
</tbody>
</table>
<p>That was the only time! At first I thought it might have been a mistake, but <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span> mentions, in the Gray Jay historical records section, that at least two Gray Jays were seen that winter.</p>
<p>How does the first year’s count compare to the most recent year’s count?</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(year == max(year),
         how_many_counted != 0) %&gt;%
  arrange(-how_many_counted, species) %&gt;%
  head(15) %&gt;%
  kable() %&gt;%
  kable_styling(full_width = FALSE, position = &quot;left&quot;)</code></pre>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
species_latin
</th>
<th style="text-align:right;">
how_many_counted
</th>
<th style="text-align:right;">
total_hours
</th>
<th style="text-align:right;">
how_many_counted_by_hour
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Canada Goose
</td>
<td style="text-align:left;">
Branta canadensis
</td>
<td style="text-align:right;">
6665
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
33.534591
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Mallard
</td>
<td style="text-align:left;">
Anas platyrhynchos
</td>
<td style="text-align:right;">
5034
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
25.328302
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Long-tailed Duck
</td>
<td style="text-align:left;">
Clangula hyemalis
</td>
<td style="text-align:right;">
3465
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
17.433962
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
European Starling
</td>
<td style="text-align:left;">
Sturnus vulgaris
</td>
<td style="text-align:right;">
2844
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
14.309434
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
House Sparrow
</td>
<td style="text-align:left;">
Passer domesticus
</td>
<td style="text-align:right;">
2731
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
13.740880
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Common Goldeneye
</td>
<td style="text-align:left;">
Bucephala clangula
</td>
<td style="text-align:right;">
2180
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
10.968554
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Greater Scaup
</td>
<td style="text-align:left;">
Aythya marila
</td>
<td style="text-align:right;">
1378
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
6.933333
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Dark-eyed Junco
</td>
<td style="text-align:left;">
Junco hyemalis
</td>
<td style="text-align:right;">
1067
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
5.368553
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Black-capped Chickadee
</td>
<td style="text-align:left;">
Poecile atricapillus
</td>
<td style="text-align:right;">
935
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
4.704402
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Rock Pigeon (Feral Pigeon)
</td>
<td style="text-align:left;">
Columba livia (Feral Pigeon)
</td>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
4.402516
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
White-winged Scoter
</td>
<td style="text-align:left;">
Melanitta fusca
</td>
<td style="text-align:right;">
725
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
3.647799
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Mourning Dove
</td>
<td style="text-align:left;">
Zenaida macroura
</td>
<td style="text-align:right;">
699
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
3.516981
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Ring-billed Gull
</td>
<td style="text-align:left;">
Larus delawarensis
</td>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
3.164780
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
Northern Cardinal
</td>
<td style="text-align:left;">
Cardinalis cardinalis
</td>
<td style="text-align:right;">
550
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
2.767296
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
American Goldfinch
</td>
<td style="text-align:left;">
Spinus tristis
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
198.75
</td>
<td style="text-align:right;">
2.379874
</td>
</tr>
</tbody>
</table>
<p>Those species look more familiar! And almost 200 person-hours were put in, amazing!</p>
<p>In 2017, how many species were seen in total?</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(year == max(year),
         how_many_counted != 0) %&gt;%
  count() %&gt;%
  pull()</code></pre>
<pre><code>## [1] 102</code></pre>
<p>102 species, nice! It’s not easy to get to 100 species during a CBC. Only four other Ontario CBCs have done it, at least by 2004 (the latest year of CBC data in <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>).</p>
</div>
<div id="number-of-species-counted-each-year" class="section level2">
<h2>Number of species counted each year</h2>
<p>Here is a re-creation of a plot found in <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>. It’s a plot of the number of species seen and the number of person-hours put in each year. Person-hours are the total number of hours the counters put in during that count. For example, if 3 people went out for four hours, there were 12 person-hours (4 * 3).</p>
<p>Note: In the course of creating this plot, I believe there was a error in the total hours of 1982, where the total number of hours was recorded as only 64, but there was no drop in the number of species counted that year. I think it should have actually been 164 hours, because, in 1981, there were 167 hours, and in 1983, there were 168 hours. So, in the below chunk, I’ve <code>mutate</code>d 1982 to have 164 total hours.</p>
<pre class="r"><code># Mutating total_hours and how_many_counted_by_hour that depends on it

hamilton_cbc &lt;- hamilton_cbc %&gt;%
  mutate(total_hours = ifelse(year == 1982, 164, total_hours),
         how_many_counted_by_hour = as.double(how_many_counted) / total_hours)


hamilton_cbc %&gt;%
  group_by(year, total_hours) %&gt;% # Bringing total_hours along for the grouping. Adding it won&#39;t affect the grouping because its value is constant within the grouping of each year
  filter(how_many_counted != 0) %&gt;%
  summarise(number_of_species_that_year = n()) %&gt;%
  ggplot() +
  geom_line(aes(x = year, y = number_of_species_that_year),
            col = &quot;blue&quot;,
            size = 1) +
    geom_line(aes(x = year, y = total_hours),
              col = &quot;orange&quot;,
              size = 1) +
  labs(x = &quot;Year&quot;,
       y = &quot;Number of species and person-hours&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/species_and_person_hours-1.png" width="672" /></p>
<p>As <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span> notes, as the number of hours of person-hours increases, so does the number of species counted. But it looks as though this is only true up to a point, after which the number of species levels off. This probably means that, as long as there are at least 150 or so person-hours in a count, the Hamilton CBC counters will be finding all or almost all of the species in the Hamilton area on count day.</p>
<p>Here is a plot of the cumulative number of species seen during the count. I think the main conclusion of this plot is that it is getting harder to see new species every year, which makes sense.</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(how_many_counted != 0) %&gt;%
  group_by(species) %&gt;%
  filter(year == min(year)) %&gt;% # What&#39;s the first year any species was counted?
  ungroup() %&gt;%
  group_by(year) %&gt;%
  summarise(number_of_new_species_that_year = n()) %&gt;%
  mutate(cumulative_new_species = cumsum(number_of_new_species_that_year)) %&gt;%
  ggplot() +
  geom_point(aes(x = year, y = cumulative_new_species)) +
  labs(x = &quot;Year&quot;,
       y = &quot;Cumulative number of species counted&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/cumulative_total_number_of_birds-1.png" width="672" /></p>
</div>
<div id="highlighting-specific-species" class="section level2">
<h2>Highlighting specific species</h2>
<p>I now want to look at some of the species and how their counts have changed over the course of the count’s history. There is a lot to look at!</p>
<p><span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span> mentions that the Hamilton CBC count circle was a different size before 1955, so, for most of the plots, I will only show information starting after 1955. But sometimes I think it’s interesting to look at all years of the data, so I might do that too! :smile:</p>
<p>Since the code of these plots will be very similar, I am going to make a function for the plotting, where only the species shown and the start year will vary:</p>
<pre class="r"><code>plot_species &lt;- function(cbc_df, start_year, species_to_plot) {
  
  cbc_df %&gt;%
    filter(species %in% species_to_plot,
           year &gt;= start_year) %&gt;%
    ggplot() +
    geom_line(aes(
      x = year, 
      y = how_many_counted,
      color = species),
      size = 1) + # Put the size of the line outside of the aes because we&#39;re not varying it
    labs(x = &quot;Year&quot;,
         y = &quot;Number counted&quot;,
         color = &quot;Species&quot;) +
    facet_wrap(vars(species),
               scales = &quot;free&quot;,
               dir = &quot;v&quot;) +
    scale_y_continuous(label = scales::comma) + # Add commas for thousands where necessary
    theme(legend.position = &quot;bottom&quot;,
          legend.direction = &quot;vertical&quot;)
  
}</code></pre>
<div id="introduced-species" class="section level3">
<h3>Introduced species</h3>
<p>Everyone is interested in introduced species. The four I will be plotting are the European Starling, the House Sparrow, the Rock Pigeon, and the Ring-Necked Pheasant.</p>
<p>According to <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>, Rock Pigeons only started being counted in 1973 and House Sparrows in 1931 (possibly due to them being introduced).</p>
<p>Look at the number of European Starlings! It’s so interesting that the numbers peaked in the 1980’s and have since seen a sharp decrease. House Sparrows have been pretty consistent. Pigeon numbers have slowly increased, and there was one year, in 2005, with over double the expected number. And the Ring-necked Pheasants have declined to be almost non-existant. <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>, referencing a 1973 <em>Waterdown Review</em> article, says that a change in urbanization pattern, with areas now going directly from intensive farming to sub-divisions, with no scrubby brush period in between (which is where the pheasants liked to live), is the main reason for the decline.</p>
<pre class="r"><code>introduced &lt;- c(&quot;European Starling&quot;,
                &quot;House Sparrow&quot;,
                &quot;Rock Pigeon (Feral Pigeon)&quot;,
                &quot;Ring-necked Pheasant&quot;)

hamilton_cbc %&gt;%
  mutate(how_many_counted = ifelse(species == &quot;Rock Pigeon (Feral Pigeon)&quot; &amp;
                                     year &lt; 1973,
                                   NA,
                                   how_many_counted)) %&gt;% # Making Rock pigeon values pre-1973 to be NA as they were not counted
  plot_species(start_year = 1955,
               species_to_plot = introduced)</code></pre>
<pre><code>## Warning: Removed 18 rows containing missing values (geom_path).</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/introduced_species-1.png" width="672" /></p>
</div>
<div id="eastern-bluebird" class="section level3">
<h3>Eastern Bluebird</h3>
<p>The next species I want to look at is the Eastern Bluebird. I volunteer with a local group that maintains bluebird nest boxes and wanted to see if the Hamilton CBC numbers showed any changes in Eastern Bluebird numbers since the Ontario Eastern Bluebird Society started in 1988.</p>
<p>In <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>, there is a chapter by Bill Read called <em>History of the Eastern Bluebird in the Hamilton Study Area</em>. In that chapter, he states that the reason more bluebirds are overwintering (and thus being counted on the CBC), is mainly due to changing weather patterns. In the first half of the 20th century, bluebirds were common in the spring to fall, but would migrate south in the winter. But since the average winter temperatures have increased since the 1980’s, more birds are overwintering. I am not sure why there appear to be such regular increases and decreases since the late 1990’s though!</p>
<p>Based on Bill Read’s chapter, it sounds as though the nest boxes may not be a major reason in the changing number of bluebirds on the CBC (though they may still be helping bluebird numbers in general).</p>
<pre class="r"><code>plot_species(hamilton_cbc,
             start_year = 1955,
             species_to_plot = &quot;Eastern Bluebird&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/bluebird-1.png" width="672" /></p>
</div>
<div id="wrens" class="section level3">
<h3>Wrens</h3>
<p>In <span class="citation">Curry (<a href="#ref-hsa_birds">2006</a>)</span>,</p>
<p>I believe the “Pacific/Winter Wren” and “Winter Wren” are in fact the same species (because one of them is counted when the other one is not), so I am going to combine both of those birds into “Winter Wren”. Sometimes, birders change what they consider to be a species.</p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(str_detect(species, &quot;Wren&quot;),
         species != &quot;House Wren&quot;) %&gt;% # I am removing House Wren because of low counts
  mutate(species = ifelse(species == &quot;Pacific/Winter Wren&quot;,
                          &quot;Winter Wren&quot;,
                          species)) %&gt;%
  group_by(year, species) %&gt;%
  mutate(how_many_counted = sum(how_many_counted)) %&gt;%
  ungroup() %&gt;%
  distinct(year, species, how_many_counted) %&gt;% 
  plot_species(start_year = 1955,
               species_to_plot = .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/wren-1.png" width="672" /></p>
<pre class="r"><code>    # - DDT effect on Bald Eagles and Double-Crested Cormorants
    # - Cardinals: A bird that has been increasing over the past hundred years
    # - A sampling of wrens (Carolina, Marsh and winter), ducks (American Black duck, long-tailed, mallard, ring-necked duck), and gulls (ring-billed and herring)
    # - Chickadees and juncos (slate-coloured and regular)
    # - Cooper&#39;s, Sharp-shinned and Red-Tailed Hawks
    # - Snow buntings
    # - Canada goose
    # - Crows, west nile? Are ravens returning to their historical area?
    # - Red-breasted nuthatch and white-breasted nuthatch
    # - Pileated woodpecker (downy, hairy, red-bellied): This was my group&#39;s &quot;Bird of the Day&quot; at the most recent CBC


hamilton_cbc %&gt;%
  filter(str_detect(species, &quot;Duck&quot;),
         !(species %in% c(&quot;Tufted Duck&quot;,
                          &quot;Harlequin Duck&quot;,
                          &quot;American Black Duck x Mallard (hybrid)&quot;))) %&gt;% # Removing Tufted and Harlequin ducks due to low counts and removing the hybrid because that&#39;s not technically a species (I should probably have removed all hybrids from the whole dataset)
plot_species(1955, .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-1.png" width="672" /></p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(str_detect(species_latin, &quot;Larus&quot;),
         !str_detect(species, &quot;hybrid|kumlieni|Thayer&quot;)) %&gt;% # Removing gull hybrids or the kumlieni subspecies (?) of the Iceland Gull or the Thayer&#39;s Gull (due to the hybrids not being a real species, kumlieni being a subspecies (also with a low count) and Thayer&#39;s Gull having a low count)
  plot_species(1955, .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-2.png" width="672" /></p>
<pre class="r"><code>hamilton_cbc %&gt;%
plot_species(start_year = 1955,
             species_to_plot = c(&quot;Double-crested Cormorant&quot;,
                                 &quot;Bald Eagle&quot;)) +
  geom_vline(xintercept = 1973, size = 1) +
  geom_text(x = 1980,
            y = 90,
            label = &quot;1973: DDT was \nbanned in Canada&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-3.png" width="672" /></p>
<pre class="r"><code># I believe that &quot;Dark-eyed Junco&quot; and &quot;Dark-eyed Junco (Slate-colored)&quot; are different names for the same species (because one of them is counted when the other one is not), so I will combine them into &quot;Dark-eyed Junco&quot;. Again, I think this is a case where the official name of this bird has changed over time.

hamilton_cbc %&gt;%
  filter(species %in% c(&quot;Dark-eyed Junco&quot;,
                        &quot;Dark-eyed Junco (Slate-colored)&quot;,
                        &quot;Black-capped Chickadee&quot;)) %&gt;%
mutate(species = ifelse(species == &quot;Dark-eyed Junco (Slate-colored)&quot;, &quot;Dark-eyed Junco&quot;, species)) %&gt;%
  group_by(year, species) %&gt;%
  mutate(how_many_counted = sum(how_many_counted)) %&gt;%
  ungroup() %&gt;%
  distinct(year, species, how_many_counted) %&gt;% 
  plot_species(start_year = 1955,
               species_to_plot = .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-4.png" width="672" /></p>
<pre class="r"><code>plot_species(hamilton_cbc, 1955, c(&quot;Cooper&#39;s Hawk&quot;,
                                   &quot;Sharp-shinned Hawk&quot;,
                                   &quot;Red-tailed Hawk&quot;))</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-5.png" width="672" /></p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(str_detect(species, &quot;Woodpecker&quot;),
         year &gt;= 1955,
         species != &quot;American Three-toed Woodpecker&quot;) %&gt;% # Excluding this woodpecker due to low counts
plot_species(1955, .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-6.png" width="672" /></p>
<pre class="r"><code># American crow declining on pg 306
plot_species(hamilton_cbc, 1955, c(&quot;American Crow&quot;,
                                   &quot;Common Raven&quot;,
                                   &quot;Blue Jay&quot;)) +
  geom_vline(xintercept = 2003, size = 1) +
  geom_text(x = 2010,
            y = 4000,
            label = &quot;2003: Height of \nWest Nile virus&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-7.png" width="672" /></p>
<pre class="r"><code>hamilton_cbc %&gt;%
  filter(species %in% c(&quot;Red-breasted Nuthatch&quot;,
                        &quot;White-breasted Nuthatch&quot;)) %&gt;%
  plot_species(1955, .$species)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-8.png" width="672" /></p>
<pre class="r"><code>plot_species(hamilton_cbc, 1955, &quot;Canada Goose&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-9.png" width="672" /></p>
<pre class="r"><code># Snow buntings had huge peaks in the 1970&#39;s
plot_species(hamilton_cbc, 1921, &quot;Snow Bunting&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-10.png" width="672" /></p>
<pre class="r"><code>plot_species(hamilton_cbc, 1921, &quot;Ruffed Grouse&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-11.png" width="672" /></p>
<pre class="r"><code>plot_species(hamilton_cbc, 1921, &quot;Northern Cardinal&quot;)</code></pre>
<p><img src="/post/hamilton_cbc_part_2/index_files/figure-html/plot-12.png" width="672" /></p>
<p>In the next blog post, I will be making a Shiny app so that anyone can dig into the data!</p>
<p>And thank you to the CBC! The CBC Data was provided by <a href="www.christmasbirdcount.org">National Audubon Society</a> and through the generous efforts of <a href="www.bsc-eoc.org">Bird Studies Canada</a> and countless volunteers across the western hemisphere.</p>
<div id="refs" class="references">
<div id="ref-hsa_birds">
<p>Curry, Robert. 2006. <em>Birds of Hamilton and Surrounding Areas</em>. Heidy Lawrance Associates. <a href="http://hamiltonnature.org/publications/birds-of-hamilton/" class="uri">http://hamiltonnature.org/publications/birds-of-hamilton/</a>.</p>
</div>
</div>
</div>
</div>
</div>
