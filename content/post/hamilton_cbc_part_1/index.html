---
title: 'Hamilton Christmas Bird Count: Part 1'
subtitle: 'Data importing and cleaning of all of the Hamilton CBC data'
author: Sharleen
date: '2019-01-07'
slug: hamilton-christmas-bird-count-part-1
categories: []
tags:
  - data analysis
  - R
  - natural history
  - ornithology
  - ecology
  - birding
  - regex
  - tidyverse
draft: false
image:
  caption: 'Image credit: [**Public Domain Pictures**](https://www.publicdomainpictures.net/en/view-image.php?image=243075&picture=black-capped-chickadee-on-branch-3)'
  preview_only: false
editor_options:
  chunk_output_type: console
---



<div id="note" class="section level1">
<h1>Note</h1>
<p>This is the first part of three for this data set. Part 1 contains only data cleaning, Part 2 contains visualization and analysis, and Part 3 contains a Shiny app.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>About two years ago, I was taking my dog for a walked through the park and I began to realize that birds are fascinating! I began regularly going out birding (or “bird-watching”) and reading up on these cool little flying dinosaurs.</p>
<p>It turns out there’s a lot of data in the birding world as well. Birding attracts the sort of detail-oriented person who likes to count and record stuff.</p>
<p>So there are lots of opportunities to get involved in citizen science projects, including a long-running project called the “Christmas Bird Count”. It started in 1900, when Frank Chapman, an ornithologist, came up with the idea as an alternative to hunting birds at Christams (which used to be the tradition)<a href="https://news.nationalgeographic.com/news/2014/12/141227-christmas-bird-count-anniversary-audubon-animals-science/">1</a>.</p>
<p>Birders have been going out every year around Christmas, to spnd their day walking, biking, or driving around a census area to count all the birds they see or hear.</p>
<p>For the past two years, I have gone out with Hamilton’s Christmas Bird Count. I learn a lot while I’m out there and it feels like we are contributing to a larger purpose because we are collecting data.</p>
<p>So I thought I would look at the data and see what it could tell me!</p>
<p>More specifically, I’ve been curious about bird counts in general, because birders will say things like “the House Sparrows are getting worse every year” or “the number of Bald Eagles have increased”, and I wondered if looking at the Christmas Bird Count data could answer some of those questions.</p>
<p>I went on the <a href="https://www.birdscanada.org/index.jsp">Bird Studies Canada</a> website, clicked on Citizen Science, then Christmas Bird Count, then CBC Audubon Database, and then Historical Results by Count. I downloaded all years of data that existed for the Hamilton count.</p>
</div>
<div id="data-cleaning" class="section level1">
<h1>Data cleaning</h1>
<p>I started by loading all of the packages I will be using:</p>
<pre class="r"><code>library(dplyr)
library(janitor)
library(readr)
library(tidyr)
library(naniar)
library(lubridate)
library(measurements)
library(stringr)
library(ggplot2)
library(purrr)</code></pre>
<p>I read in all of the data using the <a href="https://readr.tidyverse.org/"><code>readr</code></a> package.</p>
<pre class="r"><code>hamilton_cbc &lt;- read_csv(&quot;hamilton-cbc-all-years-csv.csv&quot;)</code></pre>
<p>It turns out that the first two lines just give information about which count it is and latitude/longitude, so I extracted those two pieces of information as <code>current_circle_name</code> and <code>lat_long</code> and then <a href="https://dplyr.tidyverse.org/reference/slice.html"><code>slice</code>d</a> the file so that the first two lines are excluded from the dataset. I then used <code>clean_names</code> from the very cool <a href="https://www.rdocumentation.org/packages/janitor/versions/1.1.1/topics/clean_names"><code>janitor</code></a> package.</p>
<pre class="r"><code>head(hamilton_cbc, n = 14)</code></pre>
<pre><code>## # A tibble: 14 x 9
##    CircleName Abbrev   LatLong     X4      X5     X6     X7     X8    X9   
##    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
##  1 Hamilton   ONHA     43.2678790~ &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  3 CountYear3 LowTemp  HighTemp    AMCloud PMClo~ AMRain PMRain AMSn~ PMSn~
##  4 118        -18.0 C~ -13.0 Cels~ Clear   Clear  None   None   None  None 
##  5 117        -2.0 Ce~ 11.0 Celsi~ Cloudy  Cloudy Light  &quot;Heav~ None  None 
##  6 116        -2.0 Ce~ 5.0 Celsius Partly~ Partl~ None   Light  None  None 
##  7 115        0.6 Cel~ 8.3 Celsius Cloudy  Cloudy None   None   None  None 
##  8 114        -4.0 Ce~ -1.0 Celsi~ Cloudy  Cloudy &lt;NA&gt;   &lt;NA&gt;   Light None 
##  9 113        -2.0 Ce~ -2.0 Celsi~ Cloudy  Cloudy None   None   Light Light
## 10 112        1.0 Cel~ 6.0 Celsius Cloudy  Cloudy None   None   None  None 
## 11 111        19.0 Ce~ 23.0 Celsi~ Cloudy  Cloudy None   None   None  None 
## 12 110        34.0 Ce~ 39.0 Celsi~ Cloudy  Cloudy &quot;Heav~ None   None  None 
## 13 109        30.0 Ce~ 34.0 Celsi~ Cloudy  Cloudy None   None   None  None 
## 14 108        25.0 Ce~ 28.0 Celsi~ Foggy   Foggy  None   None   None  None</code></pre>
<pre class="r"><code>current_circle_name &lt;- hamilton_cbc[1, 1]
lat_long &lt;- hamilton_cbc[1, 3]

hamilton_cbc &lt;- hamilton_cbc %&gt;%
  slice(3 : n())

hamilton_cbc &lt;- hamilton_cbc %&gt;%
  clean_names()</code></pre>
<p>Since I played around with this dataset before writing this, it turns out that there are actually five tables in this dataset: The first three tables contain weather data of the count day. I determined that a lot of the weather data is missing or mis-labelled and I’m not sure what the units are for the temperature column (sometimes it’s hard-coded in as Celsius or Fahrenheit and sometimes there’s no units). Since I will be doing another blog post about historical weather trends, I will remove these first three tables from the dataset.</p>
<p>Here is the end of the first table and the start of the second table. There is a line of <code>NA</code>s between the two tables:</p>
<pre class="r"><code>hamilton_cbc %&gt;% slice(47:57)</code></pre>
<pre><code>## # A tibble: 11 x 9
##    circle_name abbrev   lat_long  x4      x5      x6     x7     x8    x9   
##    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
##  1 66          10       25        Clear   Clear   Unkno~ Unkno~ Unkn~ Unkn~
##  2 65          18       31        Cloudy  Cloudy  Unkno~ Unkno~ Unkn~ Unkn~
##  3 64          26       34        Cloudy  Cloudy  Unkno~ Unkno~ Unkn~ Unkn~
##  4 63          21       36        Cloudy  Cloudy  Unkno~ Unkno~ Unkn~ Unkn~
##  5 &lt;NA&gt;        &lt;NA&gt;     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  6 CountYear5  LowTemp3 HighTemp2 AMClou~ PMClou~ &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  7 118         12/26/2~ 85        198.75  100     &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  8 117         12/26/2~ 95        216.65  97      &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
##  9 116         12/26/2~ 107       221     94      &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
## 10 115         12/26/2~ 80        179.25  99      &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 
## 11 114         12/26/2~ 93        182.2   98      &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</code></pre>
<p>Here is the end of the second table and the start of the third table. There is a line of <code>NA</code>s between the two tables:</p>
<pre class="r"><code>hamilton_cbc %&gt;% slice(142:152)</code></pre>
<pre><code>## # A tibble: 11 x 9
##    circle_name abbrev          lat_long x4    x5    x6    x7    x8    x9   
##    &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
##  1 27          12/26/1926      13       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  2 26          12/26/1925      10       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  3 25          12/27/1924      8        &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  4 23          12/26/1922      9        &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  5 22          12/23/1921      2        8     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  6 &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  7 CountYear4  LowTemp2        &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  8 118         Hamilton Natur~ &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  9 117         Hamilton Natur~ &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 10 116         Hamilton Natur~ &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 11 115         &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</code></pre>
<p>Here is the end of the third table and the start of the fourth table. There is a line of <code>NA</code>s between the two tables. The fourth table is where the bird count data actually starts!</p>
<pre class="r"><code>hamilton_cbc %&gt;% slice(240:250)</code></pre>
<pre><code>## # A tibble: 11 x 9
##    circle_name   abbrev       lat_long x4     x5    x6    x7    x8    x9   
##    &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
##  1 25            &lt;NA&gt;         &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  2 23            &lt;NA&gt;         &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  3 22            &lt;NA&gt;         &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  4 &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  5 COM_NAME      CountYear    how_man~ Numbe~ Flags &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  6 &quot;Snow Goose\~ &quot;1921 [22]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  7 &quot;Snow Goose\~ &quot;1922 [23]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  8 &quot;Snow Goose\~ &quot;1924 [25]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
##  9 &quot;Snow Goose\~ &quot;1925 [26]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 10 &quot;Snow Goose\~ &quot;1926 [27]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 11 &quot;Snow Goose\~ &quot;1928 [29]\~ &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</code></pre>
<p>I decided to programmatically separate the first three tables out from the dataset, in order to be able to easily replicate this analysis when more years’ data gets added, or if I want to repeat this analysis for another count area.</p>
<pre class="r"><code># Declare two lists, one for each table and one for the header of each table
meta_data_table &lt;- list()
meta_data_table_headers &lt;- list()


for (i in 1:3) {
  
  # For each of the three tables, put the first row of data into this variable (i.e., the header data)
  meta_data_table_headers[[i]] &lt;- hamilton_cbc[1, ] %&gt;%
    replace(is.na(.), &quot;NA&quot;)  # If a column name is NA, replace that with the letters &quot;NA&quot;, in case there is data in the column
  
  
  j &lt;- 2  # Start j at 2, because we want to exclude the header row
  meta_data_row &lt;- list()
  
  # Add each row of data to meta_data_row
  while (!is.na(hamilton_cbc[[&quot;circle_name&quot;]][j])) {  # &quot;circle_name&quot; being the name of the first column and we know there is a row of NAs between each table
    meta_data_row[[j]] &lt;- hamilton_cbc[j, ]
    j &lt;- j + 1
  }
  
  meta_data_table[[i]] &lt;- meta_data_row %&gt;%
    bind_rows()

  
  meta_data_table[[i]] &lt;- meta_data_table[[i]] %&gt;%
    rename_all(funs(meta_data_table_headers[[i]])) %&gt;%
    remove_empty(which = &quot;cols&quot;) %&gt;% 
    rename(count_year = 1) %&gt;%  # rename knows we are referring to the first column!
    clean_names()

  
  # Remove the meta-data table from the rest of the data set
  hamilton_cbc &lt;- hamilton_cbc %&gt;%
    slice((j + 1) : n())
}</code></pre>
<p>Whew! So now we have a list <code>meta_data_table</code> that contains the three meta-data tables.</p>
<p>In the below code chunk, I converted the three tables in the <code>meta_data_table</code> list into one <code>overall_meta_data</code> table using <a href="https://purrr.tidyverse.org/"><code>purrr</code></a>.</p>
<p>Then, using the <code>replace_with_na_all</code> function from the <a href="https://purrr.tidyverse.org/"><code>naniar</code></a> package, anywhere the data said “Unknown”, I converted it to a proper <code>NA</code>.</p>
<p>I then <code>mutate</code>d the variables: I used the <code>mdy</code> and <code>year</code> functions from the <a href="https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html"><code>lubridate</code></a> to convert the character variables <code>low_temp3</code> (actually a date variable) and <code>date</code> into a <code>Date</code> and <code>dbl</code> variable, respectively.</p>
<p>I also used the <code>word</code> function from the <a href="https://cran.r-project.org/web/packages/stringr/vignettes/stringr.html"><code>stringr</code></a> package. It extracts out only the first word from a character string.</p>
<pre class="r"><code># Reduce documentation: reduce(list(x1, x2, x3), f) is equivalent to f(f(x1, x2), x3)

overall_meta_data &lt;- meta_data_table %&gt;%
  reduce(full_join, by = &quot;count_year&quot;)

overall_meta_data &lt;- overall_meta_data %&gt;%
  replace_with_na_all(condition = ~.x == &quot;Unknown&quot;)

overall_meta_data &lt;- overall_meta_data %&gt;%
  mutate(date = mdy(low_temp3),
         low_temp = word(low_temp), # Extracts the first word from a string!
         high_temp = word(high_temp),
         year = year(date)) %&gt;%
  select(year, date, count_year, low_temp:pm_snow)
# I removed some confusing variables high_temp2:pm_clouds2</code></pre>
<p>I’ve decided not to use this meta-data table though, as there is a lot of missing data, and I will do a proper analysis of the weather of Hamilton during the CBC in another post.</p>
<p>We are almost able to clean the bird count data, but first, we need to deal with the fact that there is another meta-data table below the bird count data!</p>
<pre class="r"><code>hamilton_cbc %&gt;% slice(23215:23211)</code></pre>
<pre><code>## # A tibble: 5 x 9
##   circle_name    abbrev        lat_long x4    x5    x6    x7    x8    x9   
##   &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 &quot;House Sparro~ &quot;2013 [114]\~ 1802     9.89~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 2 &quot;House Sparro~ &quot;2012 [113]\~ 1473     7.57~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 3 &quot;House Sparro~ &quot;2011 [112]\~ 1663     7.29~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 4 &quot;House Sparro~ &quot;2010 [111]\~ 1871     8.26~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## 5 &quot;House Sparro~ &quot;2009 [110]\~ 2030     10.4~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</code></pre>
<p>I won’t show the data here because it’s people’s names, but it shows the full names of the counters. It looks like the data has gotten much better in more recent years. I considered adding this data to the <code>overall_meta_table</code> but I don’t need it and I don’t know how consistent it is.</p>
<p>But first, we’ll clean up the basic data set a bit in the below chunk.</p>
<p>I used the <code>rename_all</code> function along with <code>slice(-1)</code> to remove the column names from the first row and make them the real column names.</p>
<pre class="r"><code>hamilton_cbc &lt;- hamilton_cbc %&gt;%
  remove_empty(which = &quot;cols&quot;)

hamilton_cbc &lt;- hamilton_cbc %&gt;%  # Do this line after removing empty columns!
  rename_all(funs(hamilton_cbc[1, ])) %&gt;%
  slice(-1) %&gt;%
  clean_names()

hamilton_cbc &lt;- hamilton_cbc %&gt;%
  rename(species = com_name)</code></pre>
<p>Now we can remove with the fifth data table. I noticed that every row of the bird count data included a <code>[</code> character in the species variable, so I filtered out every row in the data set that didn’t have a <code>[</code> character. Notice that I put two <code>\</code>’s in front of the <code>[</code>, that is because the <code>[</code> is a special character and <code>str_detect</code> needs to know I mean the actual character <code>[</code>, and putting two <code>\</code>’s in front of the <code>[</code> is the way to do it.</p>
<pre class="r"><code>hamilton_cbc &lt;- hamilton_cbc %&gt;%
  filter(str_detect(species, &quot;\\[&quot;))</code></pre>
<p>Now, we do some regex!</p>
</div>
<div id="i-like-kohskes-regex-which-looks-behind-for-an-open-parenthesis-looks-ahead-for-a-closing-parenthesis-and-grabs-everything-in-the-middle-lazily-.-in-other-words-.-httpsstackoverflow.comquestions8613237extract-info-inside-all-parenthesis-in-r-hamilton_cbc---hamilton_cbc-mutatespecies_latin-str_extractspecies-.-species-wordspecies-1-sep-fixed" class="section level1">
<h1>I like <span class="citation">@kohske</span>‘s regex, which looks behind for an open parenthesis ?&lt;=\(, looks ahead for a closing parenthesis ?=\), and grabs everything in the middle (lazily) .+?, in other words (?&lt;=\().+?(?=\)) # <a href="https://stackoverflow.com/questions/8613237/extract-info-inside-all-parenthesis-in-r" class="uri">https://stackoverflow.com/questions/8613237/extract-info-inside-all-parenthesis-in-r</a> hamilton_cbc &lt;- hamilton_cbc %&gt;% mutate(species_latin = str_extract(species, “(?&lt;=\[).+?(?=\])”), species = word(species, 1, sep = fixed(’[’)))</h1>
</div>
<div id="from-the-below-three-pipes-of-code-it-looks-like-the-count_year-variable-is-actually-several-variables-in-one" class="section level1">
<h1>From the below three pipes of code, it looks like the count_year variable is actually several variables in one:</h1>
</div>
<div id="year" class="section level1">
<h1>year</h1>
</div>
<div id="count_year" class="section level1">
<h1>[count_year]</h1>
</div>
<div id="count-date" class="section level1">
<h1>count date</h1>
</div>
<div id="number-of-participants" class="section level1">
<h1>number of participants</h1>
</div>
<div id="number-of-the-participants" class="section level1">
<h1>number of the participants</h1>
</div>
<div id="number-of-species-reported" class="section level1">
<h1>number of species reported</h1>
</div>
<div id="total-hours-spent" class="section level1">
<h1>total hours spent</h1>
</div>
<div id="this-is-all-metadata-and-we-can-take-it-out-of-here-and-put-it-in-our-metadata-file" class="section level1">
<h1>This is all metadata and we can take it out of here and put it in our metadata file</h1>
</div>
<div id="but-first-we-should-parse-out-the-year-so-we-can-join-it-with-the-metadata-later-if-we-would-like" class="section level1">
<h1>But first, we should parse out the year, so we can join it with the metadata later if we would like</h1>
<p>hamilton_cbc %&gt;% filter(row_number() == 1) %&gt;% pull(count_year)</p>
<p>hamilton_cbc %&gt;% filter(row_number() == n()) %&gt;% pull(count_year)</p>
<p>hamilton_cbc %&gt;% filter(row_number() == n() - 1) %&gt;% pull(count_year)</p>
</div>
<div id="yes-it-is-metadata-with-only-one-value-per-year" class="section level1">
<h1>Yes, it is metadata, with only one value per year!</h1>
<p>hamilton_cbc %&gt;% count(count_year) #%&gt;% View()</p>
</div>
<div id="take-it-out-of-the-hamilton_cbc-dataset" class="section level1">
<h1>Take it out of the hamilton_cbc dataset</h1>
<p>count_participant_metadata &lt;- hamilton_cbc %&gt;% distinct(participant_info = count_year) %&gt;% mutate(year = word(participant_info)) %&gt;% mutate(number_of_participants = str_extract(participant_info, “(?&lt;=Participants:\s).+?(?=\s#)”)) %&gt;% # Getting everything between the “Participants:” and &quot; #&quot; mutate(species_reported = str_extract(participant_info, “(?&lt;=Reported:\s).+?(?=\nTotal)”)) %&gt;% mutate(total_hours = str_extract(participant_info, “(?&lt;=Hrs\.:\s).*$“)) # Different regex because it is at the end of the string: <a href="https://forum.sublimetext.com/t/regex-match-everything-after-this-word/20764" class="uri">https://forum.sublimetext.com/t/regex-match-everything-after-this-word/20764</a></p>
<p>count_participant_metadata &lt;- count_participant_metadata %&gt;% select(year, total_hours)</p>
<p>overall_meta_data &lt;- count_participant_metadata %&gt;% mutate(year = as.integer(year), total_hours = as.double(total_hours)) %&gt;% full_join(overall_meta_data, by = “year”)</p>
<p>hamilton_cbc &lt;- hamilton_cbc %&gt;% rename(participant_info = count_year, how_many_counted = how_many_cw) %&gt;% mutate(year = as.integer(word(participant_info)))</p>
<p>```</p>
<p>CBC Data was provided by <a href="www.christmasbirdcount.org">National Audubon Society</a> and through the generous efforts of <a href="www.bsc-eoc.org">Bird Studies Canada</a> and countless volunteers across the western hemisphere.</p>
</div>
